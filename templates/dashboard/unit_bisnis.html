{% extends "_base_dashboard.html" %}
{% load static %}

{% block title%}Dashboard Unit Bisnis - Gagasan{% endblock %}

{% block dashboard_content %}
<div class="p-8 space-y-8">
  <!-- Header Halaman -->
  <div>
    <h1 class="text-3xl font-bold text-gray-900">Dashboard Unit Bisnis</h1>
    <p class="text-sm text-gray-600 mt-1">Kelola proses kurasi produk dari seleksi hingga publikasi.</p>
  </div>

  <!-- Alur Kerja Kurasi Produk (dari image_a1d75a.png) -->
  <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
      <div class="flex items-center gap-3 mb-4">
          <i class="fas fa-sitemap text-purple-600 text-lg"></i>
          <h2 class="text-xl font-semibold">Alur Kerja Kurasi Produk</h2>
      </div>
      <!-- Indikator Tahapan -->
      <div class="flex items-center justify-between text-xs text-center mb-4">
          <div class="text-gray-400 font-medium"> <!-- Seleksi (implisit di Repository) -->
              <div class="w-6 h-6 mx-auto rounded-full bg-gray-100 flex items-center justify-center mb-1"><i class="fas fa-search"></i></div>
              Seleksi Proyek
          </div>
          <div class="flex-1 h-px bg-gray-200 mx-2"></div>
          <div class="text-purple-600 font-semibold"> <!-- Penugasan (Aktif) -->
              <div class="w-6 h-6 mx-auto rounded-full bg-purple-100 ring-2 ring-purple-300 flex items-center justify-center mb-1">1</div>
              Penugasan Kurator
          </div>
          <div class="flex-1 h-px bg-gray-200 mx-2"></div>
          <div class="text-gray-400"> <!-- Monitoring -->
              <div class="w-6 h-6 mx-auto rounded-full bg-gray-100 flex items-center justify-center mb-1">2</div>
              Monitoring Penilaian
          </div>
          <div class="flex-1 h-px bg-gray-200 mx-2"></div>
          <div class="text-gray-400"> <!-- Review -->
              <div class="w-6 h-6 mx-auto rounded-full bg-gray-100 flex items-center justify-center mb-1">3</div>
              Review & Keputusan
          </div>
           <div class="flex-1 h-px bg-gray-200 mx-2"></div>
          <div class="text-gray-400"> <!-- Publikasi -->
              <div class="w-6 h-6 mx-auto rounded-full bg-gray-100 flex items-center justify-center mb-1">4</div>
              Publikasi Katalog
          </div>
      </div>
       <!-- Info Alur Baru -->
       <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3 shadow-sm">
        <i class="fas fa-info-circle text-blue-600 mt-1"></i>
        <div>
          <h3 class="font-semibold text-blue-800">Alur Baru</h3>
          <p class="text-sm text-blue-700">Seleksi proyek dilakukan di halaman <strong>Repository</strong>. Proyek yang dipilih akan otomatis masuk ke workflow kurasi mulai dari tahap <strong>Penugasan</strong>.</p>
        </div>
      </div>
  </div>

  <!-- Statistik Utama (dari image_a1d75a.png) -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Proyek di Repository -->
    <a href="{% url 'repository' %}" class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4 hover:shadow-md hover:border-purple-300 transition-all">
      <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center shrink-0">
        <i class="fas fa-book-open text-blue-600 text-xl"></i>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500">Proyek di Repository</p>
        <p class="text-3xl font-bold text-gray-900">{{ proyek_di_repository }}</p>
        <p class="text-xs text-gray-400">Siap dipilih untuk kurasi</p>
      </div>
    </a>
    <!-- Menunggu Penugasan -->
    <a href="{% url 'assign_curator_list' %}" class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4 hover:shadow-md hover:border-purple-300 transition-all">
      <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center shrink-0">
        <i class="fas fa-user-plus text-orange-600 text-xl"></i>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500">Menunggu Penugasan</p>
        <p class="text-3xl font-bold text-gray-900">{{ proyek_menunggu_penugasan }}</p>
        <p class="text-xs text-gray-400">Perlu penugasan kurator</p>
      </div>
    </a>
     <!-- Dalam Penilaian -->
    <a href="{% url 'monitoring_penilaian_list' %}" class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4 hover:shadow-md hover:border-purple-300 transition-all">
      <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center shrink-0">
        <i class="fas fa-spinner text-yellow-600 text-xl"></i>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500">Dalam Penilaian</p>
        <p class="text-3xl font-bold text-gray-900">{{ proyek_dalam_penilaian }}</p>
        <p class="text-xs text-gray-400">Proses assessment berlangsung</p>
      </div>
    </a>
     <!-- Menunggu Keputusan -->
    <a href="{% url 'review_decision_list' %}" class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4 hover:shadow-md hover:border-purple-300 transition-all">
      <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center shrink-0">
        <i class="fas fa-gavel text-purple-600 text-xl"></i>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500">Menunggu Keputusan</p>
        <p class="text-3xl font-bold text-gray-900">{{ proyek_menunggu_keputusan }}</p>
        <p class="text-xs text-gray-400">Siap untuk review final</p>
      </div>
    </a>
    <!-- Produk Terpublikasi -->
    <a href="{% url 'catalog' %}" target="_blank" class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4 hover:shadow-md hover:border-purple-300 transition-all">
      <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center shrink-0">
        <i class="fas fa-check-circle text-green-600 text-xl"></i>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500">Produk Terpublikasi</p>
        <p class="text-3xl font-bold text-green-600">{{ proyek_terpublikasi }}</p>
        <p class="text-xs text-gray-400">Tersedia di katalog digital</p>
      </div>
    </a>
     <!-- Total Produk -->
    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4">
      <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center shrink-0">
        <i class="fas fa-database text-gray-600 text-xl"></i>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500">Total Produk</p>
        <p class="text-3xl font-bold text-gray-900">{{ total_produk }}</p>
        <p class="text-xs text-gray-400">Semua produk dalam sistem</p>
      </div>
    </div>
  </div>

  <!-- Grid 2 Kolom: Notifikasi & Aktivitas/Statistik -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    
    <!-- Kolom Kiri: Notifikasi & Akses Cepat (dari image_a1d77c.png & a1d79c.png) -->
    <div class="lg:col-span-2 space-y-8">
      
      <!-- Notifikasi & Tugas Mendesak -->
      <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
          <div class="flex items-center gap-3 mb-5">
              <i class="fas fa-bell text-orange-500 text-lg"></i>
              <h2 class="text-xl font-semibold">Notifikasi & Tugas Mendesak</h2>
          </div>
          <div class="space-y-4">
              <!-- Menunggu Penugasan -->
              {% if tugas_penugasan_mendesak > 0 %}
              <div class="p-4 bg-gray-50 rounded-lg border flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                  <div>
                      <span class="px-2 py-0.5 text-xs font-semibold rounded-full bg-orange-100 text-orange-700">Mendesak</span>
                      <p class="font-medium mt-1">{{ tugas_penugasan_mendesak }} produk menunggu penugasan kurator</p>
                      <p class="text-xs text-gray-500">Batas waktu: 2 hari lagi</p> {# TODO: Tambah logika sisa waktu nyata #}
                  </div>
                  <a href="{% url 'assign_curator_list' %}" class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors shrink-0">
                      Tindak Lanjuti <i class="fas fa-arrow-right ml-1"></i>
                  </a>
              </div>
              {% endif %}
              
              <!-- Menunggu Keputusan -->
               {% if tugas_keputusan_mendesak > 0 %}
              <div class="p-4 bg-gray-50 rounded-lg border flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                   <div>
                      <span class="px-2 py-0.5 text-xs font-semibold rounded-full bg-red-100 text-red-700">Sangat Mendesak</span>
                      <p class="font-medium mt-1">{{ tugas_keputusan_mendesak }} produk menunggu keputusan final</p>
                      <p class="text-xs text-gray-500">Sudah melewati batas review</p>
                  </div>
                  <a href="{% url 'review_decision_list' %}" class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors shrink-0">
                      Tindak Lanjuti <i class="fas fa-arrow-right ml-1"></i>
                  </a>
              </div>
              {% endif %}

              <!-- Siap Dipublikasi -->
               {% if tugas_publikasi_mendesak > 0 %}
              <div class="p-4 bg-gray-50 rounded-lg border flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                   <div>
                      <span class="px-2 py-0.5 text-xs font-semibold rounded-full bg-blue-100 text-blue-700">Perlu Perhatian</span>
                      <p class="font-medium mt-1">{{ tugas_publikasi_mendesak }} produk siap dipublikasi</p>
                      <p class="text-xs text-gray-500">Status: Layak untuk publikasi</p>
                  </div>
                  <a href="{% url 'publish_catalog_list' %}" class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors shrink-0">
                      Tindak Lanjuti <i class="fas fa-arrow-right ml-1"></i>
                  </a>
              </div>
              {% endif %}

              {% if tugas_penugasan_mendesak == 0 and tugas_keputusan_mendesak == 0 and tugas_publikasi_mendesak == 0 %}
                <p class="text-sm text-gray-500 text-center py-4">Tidak ada tugas mendesak saat ini. Kerja bagus!</p>
              {% endif %}
          </div>
      </div>

      <!-- Akses Cepat (dari image_a1d79c.png) -->
      <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
          <div class="flex items-center gap-3 mb-5">
              <i class="fas fa-rocket text-purple-600 text-lg"></i>
              <h2 class="text-xl font-semibold">Akses Cepat</h2>
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <a href="{% url 'repository' %}" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 border transition-all">
                  <p class="text-sm font-medium text-gray-500">Seleksi Awal</p>
                  <p class="font-semibold text-gray-800">Lihat Repository</p>
              </a>
               <a href="{% url 'assign_curator_list' %}" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 border transition-all">
                  <p class="text-sm font-medium text-gray-500">Tahap 1</p>
                  <p class="font-semibold text-gray-800">Tugaskan Kurator</p>
              </a>
               <a href="{% url 'monitoring_penilaian_list' %}" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 border transition-all">
                  <p class="text-sm font-medium text-gray-500">Tahap 2</p>
                  <p class="font-semibold text-gray-800">Monitor Penilaian</p>
              </a>
               <a href="{% url 'review_decision_list' %}" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 border transition-all">
                  <p class="text-sm font-medium text-gray-500">Tahap 3</p>
                  <p class="font-semibold text-gray-800">Review & Keputusan</p>
              </a>
                <a href="{% url 'publish_catalog_list' %}" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 border transition-all">
                  <p class="text-sm font-medium text-gray-500">Tahap 4</p>
                  <p class="font-semibold text-gray-800">Publikasi Katalog</p>
              </a>
               <a href="#" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 border transition-all">
                  <p class="text-sm font-medium text-gray-500">Panduan</p>
                  <p class="font-semibold text-gray-800">Lihat Workflow</p>
              </a>
          </div>
      </div>

    </div>

    <!-- Kolom Kanan: Aktivitas & Statistik Kategori (dari image_a1d77c.png & a1d79c.png) -->
    <div class="lg:col-span-1 space-y-8">

        <!-- Aktivitas Terkini -->
        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
            <div class="flex items-center gap-3 mb-5">
                <i class="far fa-calendar-alt text-purple-600 text-lg"></i>
                <h2 class="text-xl font-semibold">Aktivitas Terkini</h2>
            </div>
            <div class="space-y-4">
                {% for aktivitas in aktivitas_terkini %}
                <div class="flex items-start gap-3">
                    <div class="w-3 h-3 bg-purple-500 rounded-full mt-1.5 shrink-0"></div>
                    <div>
                        <p class="text-sm font-medium text-gray-800">{{ aktivitas.nama }}</p>
                        <p class="text-xs text-gray-500">{{ aktivitas.waktu }} • {{ aktivitas.pelaku }}</p>
                    </div>
                </div>
                {% empty %}
                 <p class="text-sm text-gray-500 text-center py-4">Belum ada aktivitas terbaru.</p>
                {% endfor %}
            </div>
        </div>

        <!-- Statistik Kategori -->
        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
            <div class="flex items-center gap-3 mb-5">
                <i class="fas fa-chart-pie text-purple-600 text-lg"></i>
                <h2 class="text-xl font-semibold">Aktivitas Sistem</h2>
            </div>
            <p class="text-sm text-gray-600 mb-4">Statistik proyek berdasarkan kategori</g>
            <div class="space-y-3">
                {% for kategori in statistik_kategori %}
                <div class="flex justify-between items-center text-sm">
                    <div class="flex items-center gap-2">
                         <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                         <span class="text-gray-700">{{ kategori.nama }}</span>
                    </div>
                    <span class="font-semibold text-gray-900">{{ kategori.jumlah_proyek }} Proyek</span>
                </div>
                {% empty %}
                 <p class="text-sm text-gray-500 text-center py-4">Belum ada proyek dalam kategori apapun.</p>
                {% endfor %}
            </div>
        </div>
    </div>

  </div>
</div>
{% endblock %}

